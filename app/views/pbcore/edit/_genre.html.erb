<%
  # On create: genre_counter and genre variables come from the controller
  # On edit: they come from the defaults in the render call
  genre_name = get_values_from_datastream(@document_fedora,'descMetadata', [{:genre=>genre_counter}]).first
  base_id = "genre_#{genre_counter}"
%>

<legend>Genre:</legend>
<dl class="genre fieldset" id="<%= base_id %>">


  <%= display_field([{:genre=>genre_counter}], { :name=>"Genre Name" }) %>
  <% if params[:action] == "edit" %>
    <%= fedora_select(@document_fedora, "descMetadata", [{:genre=>genre_counter}, :ref], :choices=>Relators.lc, :include_blank => true).html_safe %>
  <% else %>
    <%= display_field([{:genre=>genre_counter}, :ref], { :name=>"Genre Ref" }) %>
  <% end %>

</dl>