<%
  # On create: publisher_counter and publisher variables come from the controller
  # On edit: they come from the defaults in the render call
  publisher_name = get_values_from_datastream(@document_fedora,'descMetadata', [{:publisher=>publisher_counter}, :name]).first
  base_id = "publisher_#{publisher_counter}"
%>

<legend>Publisher:</legend>
<dl class="publisher fieldset" id="<%= base_id %>">

  <% if params[:action] == "edit" %>

    <%= display_field([{:publisher=>publisher_counter}, :name],       { :name=>"Publisher Name" }) %>
    <%= publisher_select(publisher_counter) %>
    <%= display_field([{:publisher=>publisher_counter}, :role],       { :hidden=>TRUE }) %>
    <%= display_field([{:publisher=>publisher_counter}, :role, :ref], { :hidden=>TRUE }) %>

  <% else %>
    <%= display_field([{:publisher=>publisher_counter}, :name],       { :name=>"Publisher Name" }) %>
    <%= display_field([{:publisher=>publisher_counter}, :role],       { :name=>"Publisher Role" }) %>
    <%= display_field([{:publisher=>publisher_counter}, :role, :ref], { :name=>"Publisher Ref" }) %>
  <% end %>

</dl>
