<%
  # On create (with AJAX): contributor_counter and contributor variables come from the controller
  # Eveything else: they come from the defaults in the render call
  contributor_name = get_values_from_datastream(@document_fedora,'descMetadata', [{:contributor=>contributor_counter}, :name]).first
  base_id = "contributor_#{contributor_counter}"
%>

<legend>Contributors:</legend>
<dl class="contributor fieldset" id="<%= base_id %>">

  <% if params[:action] == "edit" %>
    <%= display_field([{:contributor=>contributor_counter}, :name],       { :name=>"Contributor Name" }) %>
    <%= contributor_select(contributor_counter) %>
    <%= display_field([{:contributor=>contributor_counter}, :role],       { :hidden=>TRUE }) %>
    <%= display_field([{:contributor=>contributor_counter}, :role, :ref], { :hidden=>TRUE }) %>
  <% else %>
    <%= display_field([{:contributor=>contributor_counter}, :name],       { :name=>"Contributor Name" }) %>
    <%= display_field([{:contributor=>contributor_counter}, :role],       { :name=>"Contributor Role" }) %>
    <%= display_field([{:contributor=>contributor_counter}, :role, :ref], { :name=>"Contributor Ref" }) %>
  <% end %>

</dl>

